{"version":3,"sources":["webpack:///./src/views/authox/pages/role/roleEdit.vue?3e08","webpack:///src/views/authox/pages/role/roleEdit.vue","webpack:///./src/views/authox/pages/role/roleEdit.vue?7291","webpack:///./src/views/authox/pages/role/roleEdit.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","go","_v","directives","name","rawName","value","expression","stopPropagation","modal","slot","_s","roleInfo","role","des","_l","item","index","key","_f","createtimestamp","isEdited","_e","saveRole","cancelRole","staticStyle","rules","objs","objectTag","op","checked","opes","subjectsColumns","subjects","saveData","loadData","model","callback","$$v","$set","staticRenderFns","component"],"mappings":"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","file":"js/chunk-2d0af109.d7613eda.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"edit_view\"},[_c('div',{staticClass:\"back\"},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.$router.go(-1)}}},[_vm._v(\"返回\")])],1),_c('Collapse',{attrs:{\"value\":\"1\"}},[_c('Panel',{attrs:{\"name\":\"1\",\"hide-arrow\":true}},[_vm._v(\" 角色详情 \"),_c('Button',{directives:[{name:\"authox\",rawName:\"v-authox\",value:('authox|manage'),expression:\"'authox|manage'\"}],attrs:{\"type\":\"text\",\"size\":\"small\"},on:{\"click\":function($event){$event.stopPropagation();_vm.modal=true}}},[_vm._v(\"编辑基本信息\")]),_c('div',{attrs:{\"slot\":\"content\"},slot:\"content\"},[_c('table',{staticClass:\"info_table\",attrs:{\"cellspacing\":\"0\",\"cellpadding\":\"0\",\"border\":\"0\"}},[_c('tr',[_c('td',[_c('span',[_vm._v(\"角色标识：\")]),_c('span',[_vm._v(_vm._s(_vm.roleInfo.role))])]),_c('td',[_c('span',[_vm._v(\"角色名：\")]),_c('span',[_vm._v(_vm._s(_vm.roleInfo.name))])]),_c('td',[_c('span',[_vm._v(\"备注：\")]),_c('span',[_vm._v(_vm._s(_vm.roleInfo.des))])])]),_c('tr',[_c('td',[_c('span',[_vm._v(\"父节点：\")]),_vm._l((_vm.roleInfo.parents),function(item,index){return _c('Tag',{key:index,attrs:{\"type\":\"border\",\"color\":\"primary\"}},[_vm._v(_vm._s(item))])})],2),_c('td',[_c('span',[_vm._v(\"创建时间：\")]),_c('span',[_vm._v(_vm._s(_vm._f(\"dateFormat\")(_vm.roleInfo.createtimestamp,\"yyyy-MM-dd HH:mm:ss\")))])])])])])],1)],1),_c('Collapse',{attrs:{\"value\":\"1\"}},[_c('Panel',{attrs:{\"name\":\"1\",\"hide-arrow\":true}},[_vm._v(\" 角色权限 \"),(_vm.isEdited)?_c('Button',{attrs:{\"type\":\"text\",\"size\":\"small\"},on:{\"click\":function($event){$event.stopPropagation();_vm.isEdited = false}}},[_vm._v(\"编辑权限\")]):_vm._e(),(!_vm.isEdited)?_c('Button',{attrs:{\"type\":\"text\",\"size\":\"small\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.saveRole($event)}}},[_vm._v(\"保存修改\")]):_vm._e(),(!_vm.isEdited)?_c('Button',{attrs:{\"type\":\"text\",\"size\":\"small\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.cancelRole($event)}}},[_vm._v(\"取消修改\")]):_vm._e(),_c('div',{attrs:{\"slot\":\"content\"},slot:\"content\"},[_c('table',{staticClass:\"info_table\",attrs:{\"cellspacing\":\"0\",\"cellpadding\":\"0\",\"border\":\"0\"}},[_c('tr',[_c('th',{staticStyle:{\"width\":\"120px\"}},[_vm._v(\"客体\")]),_c('th',[_vm._v(\"操作项\")])]),_vm._l((_vm.allRules),function(rules){return _c('tr',[_c('td',[_c('span',{staticStyle:{\"line-height\":\"2\"}},[_vm._v(_vm._s(_vm.objs[rules.objectTag]))])]),_c('td',_vm._l((rules.ops),function(op){return _c('span',[_c('Button',{attrs:{\"type\":op.checked?'default':'text',\"icon\":op.checked?'md-checkmark':'',\"disabled\":_vm.isEdited},on:{\"click\":function($event){op.checked=!op.checked}}},[_vm._v(_vm._s(_vm.opes[op.op]))])],1)}),0)])})],2)])],1)],1),_c('Collapse',{attrs:{\"value\":\"1\"}},[_c('Panel',{attrs:{\"name\":\"1\",\"hide-arrow\":true}},[_vm._v(\" 引用记录 \"),_c('div',{attrs:{\"slot\":\"content\"},slot:\"content\"},[_c('Table',{attrs:{\"columns\":_vm.subjectsColumns,\"data\":_vm.subjects,\"size\":\"small\",\"stripe\":\"\"}})],1)])],1),_c('Modal',{attrs:{\"title\":\"编辑角色\"},on:{\"on-ok\":_vm.saveData,\"on-cancel\":function($event){_vm.modal = false;_vm.loadData();}},model:{value:(_vm.modal),callback:function ($$v) {_vm.modal=$$v},expression:\"modal\"}},[_c('Form',{attrs:{\"model\":_vm.roleInfo,\"label-width\":80}},[_c('FormItem',{attrs:{\"label\":\"*角色名称\"}},[_c('Input',{attrs:{\"type\":\"text\"},model:{value:(_vm.roleInfo.name),callback:function ($$v) {_vm.$set(_vm.roleInfo, \"name\", $$v)},expression:\"roleInfo.name\"}})],1),_c('FormItem',{attrs:{\"label\":\"父节点\"}},[_c('Select',{attrs:{\"multiple\":\"\"},model:{value:(_vm.roleInfo.parents),callback:function ($$v) {_vm.$set(_vm.roleInfo, \"parents\", $$v)},expression:\"roleInfo.parents\"}},_vm._l((_vm.roleList),function(item){return _c('Option',{key:item.role,attrs:{\"value\":item.name,\"label\":item.name}})}),1)],1),_c('FormItem',{attrs:{\"label\":\"备注\"}},[_c('Input',{attrs:{\"type\":\"text\"},model:{value:(_vm.roleInfo.des),callback:function ($$v) {_vm.$set(_vm.roleInfo, \"des\", $$v)},expression:\"roleInfo.des\"}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"edit_view\">\r\n        <div class=\"back\">\r\n            <Button type=\"primary\" @click=\"$router.go(-1)\">返回</Button>\r\n        </div>\r\n        <Collapse value=\"1\">\r\n            <Panel name=\"1\" :hide-arrow=\"true\">\r\n                角色详情\r\n                <Button type=\"text\" size=\"small\" @click.stop=\"modal=true\" v-authox=\"'authox|manage'\">编辑基本信息</Button>\r\n                <div slot=\"content\">\r\n                    <table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" class=\"info_table\">\r\n                        <tr>\r\n                            <td>\r\n                                <span>角色标识：</span>\r\n                                <span>{{roleInfo.role}}</span>\r\n                            </td>\r\n                            <td>\r\n                                <span>角色名：</span>\r\n                                <span>{{roleInfo.name}}</span>\r\n                            </td>\r\n                            <td>\r\n                                <span>备注：</span>\r\n                                <span>{{roleInfo.des}}</span>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>\r\n                                <span>父节点：</span>\r\n                                <Tag type=\"border\" color=\"primary\" v-for=\"(item,index) in roleInfo.parents\" :key=\"index\">{{item}}</Tag>\r\n                            </td>\r\n                            <td>\r\n                                <span>创建时间：</span>\r\n                                <span>{{roleInfo.createtimestamp | dateFormat(\"yyyy-MM-dd HH:mm:ss\")}}</span>\r\n                            </td>\r\n                        </tr>\r\n                    </table>\r\n                </div>\r\n            </Panel>\r\n        </Collapse>\r\n        <Collapse value=\"1\">\r\n            <Panel name=\"1\" :hide-arrow=\"true\">\r\n                角色权限\r\n                <Button type=\"text\" size=\"small\" @click.stop=\"isEdited = false\" v-if=\"isEdited\">编辑权限</Button>\r\n                <Button type=\"text\" size=\"small\" @click.stop=\"saveRole\" v-if=\"!isEdited\">保存修改</Button>\r\n                <Button type=\"text\" size=\"small\" @click.stop=\"cancelRole\" v-if=\"!isEdited\">取消修改</Button>\r\n                <div slot=\"content\">\r\n                    <table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" class=\"info_table\">\r\n                        <tr>\r\n                            <th style=\"width:120px;\">客体</th>\r\n                            <th>操作项</th>\r\n                        </tr>\r\n                        <tr v-for=\"rules in allRules\">\r\n                            <td><span style=\"line-height: 2;\">{{objs[rules.objectTag]}}</span></td>\r\n                            <td>\r\n                                <span v-for=\"op in rules.ops\">\r\n                                    <Button :type=\"op.checked?'default':'text'\" :icon=\"op.checked?'md-checkmark':''\"\r\n                                        @click=\"op.checked=!op.checked\" :disabled=\"isEdited\">{{opes[op.op]}}</Button>\r\n                                </span>\r\n                            </td>\r\n                        </tr>\r\n                    </table>\r\n                </div>\r\n            </Panel>\r\n        </Collapse>\r\n        <Collapse value=\"1\">\r\n            <Panel name=\"1\" :hide-arrow=\"true\">\r\n                引用记录\r\n                <div slot=\"content\">\r\n                    <Table :columns=\"subjectsColumns\" :data=\"subjects\" size=\"small\" stripe></Table>\r\n                </div>\r\n            </Panel>\r\n        </Collapse>\r\n        <Modal v-model=\"modal\" title=\"编辑角色\" @on-ok=\"saveData\" @on-cancel=\"modal = false;loadData();\">\r\n            <Form :model=\"roleInfo\" :label-width=\"80\">\r\n                <FormItem label=\"*角色名称\">\r\n                    <Input type=\"text\" v-model=\"roleInfo.name\"></Input>\r\n                </FormItem>\r\n                <FormItem label=\"父节点\">\r\n                    <Select v-model=\"roleInfo.parents\" multiple>\r\n                        <Option v-for=\"item in roleList\" :value=\"item.name\" :key=\"item.role\" :label=\"item.name\"></Option>\r\n                    </Select>\r\n                </FormItem>\r\n                <FormItem label=\"备注\">\r\n                    <Input type=\"text\" v-model=\"roleInfo.des\"></Input>\r\n                </FormItem>\r\n            </Form>\r\n        </Modal>\r\n    </div>\r\n</template>\r\n<script>\r\n    import {\r\n        Collapse, Button, Modal,\r\n        Panel,\r\n        Transfer, FormItem, Form, Input, Table\r\n    } from 'iview';\r\n\r\n    export default {\r\n        components: {\r\n            Collapse,\r\n            Button,\r\n            Modal,\r\n            Panel,\r\n            Transfer,\r\n            Form,\r\n            FormItem,\r\n            Input,\r\n            Table\r\n        },\r\n        data() {\r\n            return {\r\n                modal: false,\r\n                id: this.$route.query.id,\r\n                isEdited: true,\r\n                subjects: [],\r\n                roleList: [],\r\n                objs: [],\r\n                opes: [],\r\n                allRules: [],\r\n                subjectsColumns: [{\r\n                    title: \"被授权对象\",\r\n                    key: \"name\"\r\n                }, {\r\n                    title: \"备注\",\r\n                    key: \"des\"\r\n                }, {\r\n                    title: \"类型\",\r\n                    key: \"type\"\r\n                }],\r\n                roleInfo: {}\r\n            }\r\n        },\r\n        created() {\r\n            this.loadData();\r\n            this.getRoleList();\r\n            this.getSubjects();\r\n            this.getRoleDetail();\r\n        },\r\n        methods: { //定义方法\r\n            loadData() {\r\n                this.$http.get(\"/rest/authox/roles/\" + this.id).then(res => {\r\n                    this.roleInfo = res.data;\r\n                }).catch(err => {\r\n                    console.log(err.data);\r\n                })\r\n            },\r\n            getRoleList() {\r\n                this.$http.get(\"/rest/authox/roles/\" + this.id + \"/validRoles\").then(res => {\r\n                    this.roleList = res.data;\r\n                }).catch(err => {\r\n                    console.log(err.data);\r\n                })\r\n            },\r\n            getSubjects() {\r\n                this.$http.get(\"/rest/authox/roles/\" + this.id + \"/subjects\").then(res => {\r\n                    this.subjects = res.data;\r\n                }).catch(err => {\r\n                    console.log(err.data);\r\n                })\r\n            },\r\n            getRoleDetail() {\r\n                this.$http.all([\r\n                    this.$http.get('rest/authox/objects'),\r\n                    this.$http.get('rest/authox/operations'),\r\n                    this.$http.get('rest/authox/objectOps')\r\n                ]).then(this.$http.spread((data1, data2, data3) => {\r\n                    this.objs = data1.data;\r\n                    this.opes = data2.data;\r\n                    let rules = data3.data;\r\n\r\n                    this.allRules = [];\r\n                    rules.forEach(i => {\r\n                        var n = false;\r\n                        this.allRules.forEach(j => {\r\n                            if (j.objectTag === i.objectcode) {\r\n                                n = true;\r\n                                j.ops.push({\r\n                                    'op': i.opcode,\r\n                                    checked: false\r\n                                })\r\n                            }\r\n                        })\r\n                        if (!n) {\r\n                            var tagObj = {};\r\n                            tagObj.objectTag = i.objectcode;\r\n                            tagObj.isEdited = false;\r\n                            tagObj.ops = [];\r\n                            tagObj.ops.push({\r\n                                'op': i.opcode,\r\n                                checked: false\r\n                            });\r\n                            this.allRules.push(tagObj)\r\n                        }\r\n                    })\r\n                    this.$http.get('rest/authox/roles/' + this.id + '/rules').then(res => {\r\n                        let data = res.data;\r\n                        data.forEach(i => {\r\n                            this.allRules.forEach(j => {\r\n                                if (i.objectTag === j.objectTag) {\r\n                                    j.ops.forEach(m => {\r\n                                        if (m.op === i.op) {\r\n                                            m.checked = true;\r\n                                        }\r\n                                    })\r\n                                }\r\n                            })\r\n                        })\r\n                    })\r\n                })).catch(err => {\r\n                    console.log(err);\r\n                })\r\n            },\r\n            saveRole() {\r\n                let data = [];\r\n                this.allRules.forEach((i) => {\r\n                    i.ops.forEach((j) => {\r\n                        if (j.checked) {\r\n                            var a = {\r\n                                objectTag: i.objectTag,\r\n                                op: j.op\r\n                            }\r\n                            data.push(a);\r\n                        }\r\n                    })\r\n                })\r\n                this.$http.post(\"rest/authox/roles/\" + this.id + \"/rules\", data).then(data => {\r\n                    this.isEdited = true;\r\n                    this.getRoleDetail();\r\n                    this.$Message.success('保存成功！');\r\n                }).catch(err => {\r\n                    this.$Message.error('保存失败！');\r\n                    console.log(err);\r\n                })\r\n            },\r\n            cancelRole() {\r\n                this.getRoleDetail();\r\n                this.isEdited = true;\r\n            },\r\n            saveData() {\r\n                let role = {\r\n                    role: this.roleInfo.role,\r\n                    name: this.roleInfo.name,\r\n                    des: this.roleInfo.des,\r\n                    parents: []\r\n                }\r\n                this.roleInfo.parents.forEach(element => {\r\n                    this.roleList.forEach(item => {\r\n                        if (item.name == element) {\r\n                            role.parents.push(item.role);\r\n                        }\r\n                    })\r\n                });\r\n                this.$http.post(\"/rest/authox/roles/\" + this.id, role).then(res => {\r\n                    this.modal = false;\r\n                    this.$Message.success('保存成功！');\r\n                    this.loadData();\r\n                }).catch(err => {\r\n                    this.$Message.error('保存失败！');\r\n                    console.log(err);\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n</style>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./roleEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./roleEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./roleEdit.vue?vue&type=template&id=7f157063&scoped=true&\"\nimport script from \"./roleEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./roleEdit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7f157063\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}