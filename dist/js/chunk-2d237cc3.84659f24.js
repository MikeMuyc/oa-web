(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d237cc3"],{fd3b:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"edit_view"},[o("div",{staticClass:"back"},[o("Button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")])],1),o("Collapse",{attrs:{value:"1"}},[o("Panel",{attrs:{name:"1","hide-arrow":!0}},[t._v(" 群组详情 "),o("Button",{attrs:{type:"text",size:"small"},on:{click:function(e){e.stopPropagation(),t.editGroup=!0}}},[t._v("编辑群组信息")]),o("div",{attrs:{slot:"content"},slot:"content"},[o("table",{staticClass:"info_table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[o("tr",[o("td",[o("span",[t._v("群组名：")]),o("span",[t._v(t._s(t.groupInfo.displayName))])]),o("td",[o("span",[t._v("备注：")]),o("span",[t._v(t._s(t.groupInfo.des))])]),o("td",[o("span",[t._v("创建时间：")]),o("span",[t._v(t._s(t._f("dateFormat")(t.groupInfo.createtimestamp,"yyyy-MM-dd HH:mm:ss")))])])])])])],1)],1),o("Collapse",{attrs:{value:"1"}},[o("Panel",{attrs:{name:"1","hide-arrow":!0}},[t._v(" 群组成员 "),o("Button",{attrs:{type:"text",size:"small"},on:{click:function(e){return e.stopPropagation(),t.editMember(e)}}},[t._v("编辑群组成员")]),o("div",{attrs:{slot:"content"},slot:"content"},[o("Table",{attrs:{columns:t.userColumns,data:t.memberList,size:"small",stripe:""}})],1)],1)],1),o("Collapse",{attrs:{value:"1"}},[o("Panel",{attrs:{name:"1","hide-arrow":!0}},[t._v(" 群组角色 "),o("Button",{attrs:{type:"text",size:"small"},on:{click:function(e){return e.stopPropagation(),t.editRole(e)}}},[t._v("编辑群组角色")]),o("div",{attrs:{slot:"content"},slot:"content"},[o("Table",{attrs:{columns:t.roleColumns,data:t.groupInfo.roles,size:"small",stripe:""}})],1)],1)],1),o("Modal",{attrs:{title:"编辑群组"},on:{"on-ok":t.saveGroup,"on-cancel":function(e){t.editGroup=!1,t.loadData()}},model:{value:t.editGroup,callback:function(e){t.editGroup=e},expression:"editGroup"}},[o("Form",{attrs:{model:t.groupInfo,"label-width":60}},[o("FormItem",{attrs:{label:"*组名"}},[o("Input",{attrs:{type:"text"},model:{value:t.groupInfo.displayName,callback:function(e){t.$set(t.groupInfo,"displayName",e)},expression:"groupInfo.displayName"}})],1),o("FormItem",{attrs:{label:"*备注"}},[o("Input",{attrs:{type:"text"},model:{value:t.groupInfo.des,callback:function(e){t.$set(t.groupInfo,"des",e)},expression:"groupInfo.des"}})],1)],1)],1),o("Modal",{attrs:{title:"编辑群组角色"},on:{"on-ok":t.saveRole,"on-cancel":function(e){t.roleModal=!1}},model:{value:t.roleModal,callback:function(e){t.roleModal=e},expression:"roleModal"}},[o("Transfer",{attrs:{data:t.roleList,"target-keys":t.targetKeys,"render-format":t.roleRender,filterable:"","filter-method":t.filterMethod,titles:["角色列表","已有角色"]},on:{"on-change":t.onChange}})],1),o("Modal",{attrs:{title:"编辑群组成员"},on:{"on-ok":t.saveMember,"on-cancel":function(e){t.memberModal=!1}},model:{value:t.memberModal,callback:function(e){t.memberModal=e},expression:"memberModal"}},[o("Transfer",{attrs:{data:t.userList,"target-keys":t.memberKeys,"render-format":t.roleRender2,filterable:"","filter-method":t.filterMethod2,titles:["用户列表","成员列表"]},on:{"on-change":t.onChange2}})],1)],1)},a=[],r=(o("4160"),o("c975"),o("b0c0"),o("159b"),o("e069")),n={components:{Collapse:r["Collapse"],Button:r["Button"],Modal:r["Modal"],Panel:r["Panel"],Transfer:r["Transfer"],Form:r["Form"],FormItem:r["FormItem"],Input:r["Input"],Table:r["Table"]},data:function(){var t=this;return{id:this.$route.query.id,editGroup:!1,roleModal:!1,memberModal:!1,userList:[],memberList:[],roleList:[],targetKeys:[],memberKeys:[],allUserList:[],userTargetKeys:[],roleColumns:[{title:"角色标识",key:"role"},{title:"角色名称",key:"name"},{title:"备注",key:"des"},{title:"创建时间",key:"",render:function(e,o){return e("div",o.row.createtimestamp?t.$utils.dateFormat(new Date(o.row.createtimestamp),"yyyy-MM-dd HH:mm:ss"):"")}}],userColumns:[{title:"账号",key:"account"},{title:"用户名",key:"displayName"},{title:"备注",key:"description"},{title:"创建时间",key:"",render:function(e,o){return e("div",o.row.createTimestamp?t.$utils.dateFormat(new Date(o.row.createTimestamp),"yyyy-MM-dd HH:mm:ss"):"")}}],groupInfo:{}}},created:function(){this.loadData(),this.getMemberList(),this.getUserList(),this.getRoleList()},methods:{loadData:function(){var t=this;this.$http.get("/rest/authox/groups/"+this.id).then((function(e){t.groupInfo=e.data})).catch((function(t){console.log(t.data)}))},getRoleList:function(){var t=this;this.$http.get("/rest/authox/roles").then((function(e){t.roleList=e.data,t.roleList.forEach((function(t,e){t.key=e+1}))})).catch((function(t){console.log(t.data)}))},getUserList:function(){var t=this;this.$http.get("/rest/authox/users").then((function(e){t.userList=e.data,t.userList.forEach((function(t,e){t.key=e+1}))})).catch((function(t){console.log(t.data)}))},getMemberList:function(){var t=this;this.$http.get("/rest/authox/groups/"+this.id+"/users").then((function(e){t.memberList=e.data})).catch((function(t){console.log(t.data)}))},editRole:function(){var t=this;this.targetKeys=[],this.groupInfo.roles.forEach((function(e){t.roleList.forEach((function(o){e.role==o.role&&t.targetKeys.push(o.key)}))})),this.roleModal=!0},editMember:function(){var t=this;this.memberKeys=[],this.memberList.forEach((function(e){t.userList.forEach((function(o){o.uid==e.uid&&t.memberKeys.push(o.key)}))})),this.memberModal=!0},saveMember:function(){var t=this,e=[];this.memberKeys.forEach((function(o){e.push(t.userList[o-1].uid)})),this.$http.post("/rest/authox/groups/"+this.id+"/users",e).then((function(e){t.memberModal=!1,t.$Message.success("保存成功！"),t.getMemberList()})).catch((function(e){t.$Message.error("保存失败！"),console.log(e.data)}))},saveRole:function(){var t=this,e=[];this.targetKeys.forEach((function(o){e.push(t.roleList[o-1].role)})),this.$http.post("/rest/authox/groups/"+this.id+"/roles",e).then((function(e){t.roleModal=!1,t.$Message.success("保存成功！"),t.loadData()})).catch((function(e){t.$Message.error("保存失败！"),console.log(e.data)}))},saveGroup:function(){var t=this;this.$http.post("/rest/authox/groups/"+this.id,this.groupInfo).then((function(e){t.editGroup=!1,t.$Message.success("保存成功！"),t.loadData()})).catch((function(e){t.$Message.error("保存失败！"),console.log(e.data)}))},filterMethod:function(t,e){return t.name.indexOf(e)>-1},filterMethod2:function(t,e){return t.displayName.indexOf(e)>-1},roleRender:function(t){return t.name},roleRender2:function(t){return t.displayName},onChange:function(t){this.targetKeys=t},onChange2:function(t){this.memberKeys=t}}},i=n,l=o("2877"),u=Object(l["a"])(i,s,a,!1,null,"f7c1e916",null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d237cc3.84659f24.js.map