(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b08e2c2"],{"320e":function(t,e,o){},"46cb":function(t,e,o){"use strict";o("320e")},"6c8e":function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"edit_view"},[o("div",{staticClass:"back"},[o("Button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")])],1),o("Collapse",{attrs:{value:"1"}},[o("Panel",{attrs:{name:"1","hide-arrow":!0}},[t._v(" 用户详情 "),o("Button",{attrs:{type:"text",size:"small"},on:{click:function(e){e.stopPropagation(),t.editModal=!0}}},[t._v("编辑基本信息")]),o("div",{attrs:{slot:"content"},slot:"content"},[o("table",{staticClass:"info_table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[o("tr",[o("td",[o("span",[t._v("账号：")]),o("span",[t._v(t._s(t.userInfo.account))])]),o("td",[o("span",[t._v("用户名：")]),o("span",[t._v(t._s(t.userInfo.displayName))])]),o("td",[o("span",{staticClass:"resetPass",on:{click:t.resetPass}},[t._v("重置密码")]),o("Icon",{attrs:{type:"md-alert",title:"重置密码为123456"}})],1)]),o("tr",[o("td",[o("span",[t._v("备注：")]),o("span",[t._v(t._s(t.userInfo.description))])]),o("td",[o("span",[t._v("创建时间：")]),o("span",[t._v(t._s(t._f("dateFormat")(t.userInfo.createTimestamp,"yyyy-MM-dd HH:mm:ss")))])])])])])],1)],1),o("Collapse",{attrs:{value:"1"}},[o("Panel",{attrs:{name:"1","hide-arrow":!0}},[t._v(" 用户角色 "),o("Button",{attrs:{type:"text",size:"small"},on:{click:function(e){return e.stopPropagation(),t.editRole(e)}}},[t._v("编辑用户角色")]),o("div",{attrs:{slot:"content"},slot:"content"},[o("Table",{attrs:{columns:t.roleColumns,data:t.userInfo.roles,size:"small",stripe:""}})],1)],1)],1),o("Collapse",{attrs:{value:"1"}},[o("Panel",{attrs:{name:"1","hide-arrow":!0}},[t._v(" 用户加入的组 "),o("div",{attrs:{slot:"content"},slot:"content"},[o("Table",{attrs:{columns:t.groupColumns,data:t.groupsList,size:"small",stripe:""}})],1)])],1),o("Modal",{attrs:{title:"编辑用户"},on:{"on-ok":t.saveData,"on-cancel":function(e){t.editModal=!1,t.loadData()}},model:{value:t.editModal,callback:function(e){t.editModal=e},expression:"editModal"}},[o("Form",{attrs:{model:t.userInfo,"label-width":60}},[o("FormItem",{attrs:{label:"*账号"}},[o("Input",{attrs:{type:"text"},model:{value:t.userInfo.account,callback:function(e){t.$set(t.userInfo,"account",e)},expression:"userInfo.account"}})],1),o("FormItem",{attrs:{label:"*用户名"}},[o("Input",{attrs:{type:"text"},model:{value:t.userInfo.displayName,callback:function(e){t.$set(t.userInfo,"displayName",e)},expression:"userInfo.displayName"}})],1),o("FormItem",{attrs:{label:"*备注"}},[o("Input",{attrs:{type:"text"},model:{value:t.userInfo.description,callback:function(e){t.$set(t.userInfo,"description",e)},expression:"userInfo.description"}})],1)],1)],1),o("Modal",{attrs:{title:"编辑用户角色"},on:{"on-ok":t.saveRole,"on-cancel":function(e){t.roleModal=!1}},model:{value:t.roleModal,callback:function(e){t.roleModal=e},expression:"roleModal"}},[o("Transfer",{attrs:{data:t.roleList,"target-keys":t.targetKeys,"render-format":t.roleRender,filterable:"","filter-method":t.filterMethod,titles:["角色列表","已有角色"]},on:{"on-change":t.onChange}})],1)],1)},a=[],n=(o("4160"),o("c975"),o("b0c0"),o("159b"),o("e069")),r={components:{Collapse:n["Collapse"],Button:n["Button"],Modal:n["Modal"],Panel:n["Panel"],Transfer:n["Transfer"],Form:n["Form"],FormItem:n["FormItem"],Input:n["Input"],Table:n["Table"]},data:function(){var t=this;return{editModal:!1,roleModal:!1,id:this.$route.query.id,roleList:[],targetKeys:[],groupsList:[],roleColumns:[{title:"角色标识",key:"role"},{title:"角色名称",key:"name"},{title:"备注",key:"des"},{title:"创建时间",key:"",render:function(e,o){return e("div",o.row.createtimestamp?t.$utils.dateFormat(new Date(o.row.createtimestamp),"yyyy-MM-dd HH:mm:ss"):"")}}],groupColumns:[{title:"组名",key:"displayName"},{title:"备注",key:"des"}],journalColumns:[{title:"操作记录",key:"role"},{title:"操作时间",key:"name"}],userInfo:{account:"",displayName:"",description:""}}},created:function(){this.loadData(),this.getRoleList(),this.getGroups()},methods:{loadData:function(){var t=this;this.$http.get("/rest/authox/users/"+this.id).then((function(e){t.userInfo=e.data})).catch((function(t){console.log(t.data)}))},getRoleList:function(){var t=this;this.$http.get("/rest/authox/roles").then((function(e){t.roleList=e.data,t.roleList.forEach((function(t,e){t.key=e+1}))})).catch((function(t){console.log(t.data)}))},getGroups:function(){var t=this;this.$http.get("/rest/authox/users/"+this.id+"/groups").then((function(e){t.groupsList=e.data})).catch((function(t){console.log(t.data)}))},saveData:function(){var t=this;this.$http.post("/rest/authox/users/"+this.id,this.userInfo).then((function(e){t.editModal=!1,t.$Message.success("保存成功！"),t.loadData()})).catch((function(e){t.$Message.error("保存失败！"),console.log(e.data)}))},editRole:function(){var t=this;this.targetKeys=[],this.userInfo.roles.forEach((function(e){t.roleList.forEach((function(o){e.role==o.role&&t.targetKeys.push(o.key)}))})),this.roleModal=!0},saveRole:function(){var t=this,e=[];this.targetKeys.forEach((function(o){e.push(t.roleList[o-1].role)})),this.$http.post("/rest/authox/users/"+this.id+"/roles",e).then((function(e){t.roleModal=!1,t.$Message.success("保存成功！"),t.loadData()})).catch((function(e){t.$Message.error("保存失败！"),console.log(e.data)}))},resetPass:function(){var t=this;this.$Modal.confirm({title:"重置密码",content:"确认重置该账号密码为123456？",onOk:function(){t.$http.post("/rest/authox/users/"+t.id+"/resetPassword").then((function(e){t.$Message.success("重置成功！")})).catch((function(e){t.$Message.error("重置失败！"),console.log(e.data)}))},onCancel:function(){}})},filterMethod:function(t,e){return t.name.indexOf(e)>-1},roleRender:function(t){return t.name},onChange:function(t){this.targetKeys=t}}},l=r,i=(o("46cb"),o("2877")),c=Object(i["a"])(l,s,a,!1,null,"6b336868",null);e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-1b08e2c2.d7e6a2bc.js.map